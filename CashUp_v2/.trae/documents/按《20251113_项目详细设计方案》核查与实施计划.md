## 执行状态结论
- 当前进度为“部分实现”；已具备核心服务、认证/配置/新闻API、RSS采集与情绪分析、基础数据库脚本与容器编排，但与设计的完整模块化架构仍有差距。
- 主要缺口：交易/策略/行情API与模块未在核心服务中对外暴露；事件系统与通知渠道未落地；Docker Compose服务路径与现有代码目录不一致；部分配置文件与共享库缺失。

## 关键证据
- 核心服务入口与健康检查：`apps/core/main.py:85-89`, `apps/core/main.py:107-120` 已注册 `auth|users|config|news` 路由与 `/health`。
- 新闻API存在：`apps/core/api/routes/news.py:17-24`, `apps/core/api/routes/news.py:57-59` 提供列表与详情。
- RSS任务与调度：`apps/core/celery_app.py:24-33` 定义 Beat 定时；任务实现见 `apps/core/tasks/rss.py:47-55`, `apps/core/tasks/rss.py:96-104`。
- 交易所适配层：`apps/core/app/adapters/exchanges/base.py:183-267` 抽象接口；`apps/core/app/adapters/exchanges/base.py:402-490` 适配器与管理器；具体实现文件存在。
- 数据库脚本对齐设计：`scripts/init_database_v2.sql:314-347`, `scripts/init_database_v2.sql:430-429`, `scripts/init_database_v2.sql:529-566`。
- Docker Compose 路径不一致：`docker-compose.yml:94-101`, `docker-compose.yml:96` 指向 `./core-service`，但实际核心代码在 `apps/core`；`trading-engine/strategy-platform` 亦指向不存在的顶层目录（备份位于 `frontend/backend-backup/...`）。

## 差距与偏差
- 路由缺失：核心服务未提供 `trading`、`strategy`、`market` API；`apps/core/api/routes` 仅见 `auth|users|config|news`。
- 事件系统未落地：未找到基于 RabbitMQ 的 `broker/publisher/subscribers`；仅有 Celery 队列与Beat。
- 通知服务最小化：顶层 `notification-service/main.py` 仅健康检查，无渠道实现与消费逻辑。
- 适配器注册器未实现：未检索到 `ExchangeRegistry`；以 `ExchangeManager` 形式存在，尚未接入API。
- 编排与目录对齐：Compose 指向的 `core-service/trading-engine/strategy-platform` 顶层目录与实际代码不一致；需统一目录与镜像构建。

## 执行方案（按阶段实施）
### 阶段1：编排与目录对齐（不改业务逻辑）
- 更新 `docker-compose.yml`：将 `core-service` 的 `build.context` 与 `volumes` 指向 `apps/core`；`notification-service` 保持不变；临时将 `trading-engine`、`strategy-platform` 指向 `frontend/backend-backup/` 对应目录以便快速联通，或先移除后续再恢复。
- 将数据库初始化改为 `scripts/init_database_v2.sql`，确保表/索引/视图与设计一致。
- 增补 `.env.example` 变量占位（`DATABASE_URL/REDIS_URL/RABBITMQ_URL/SECRET_KEY/TELEGRAM_*`），并在核心服务 `settings` 读取。

### 阶段2：核心服务补齐 API（v1 前缀，MVP）
- 新增 `apps/core/api/routes/trading.py`：
  - `POST /api/v1/trading/orders` 创建订单（调用 `ExchangeAdapter.place_order`，写入 `orders`）。
  - `GET /api/v1/trading/positions` 查询持仓（读取 `positions` 或适配器拉取后落库）。
  - `GET /api/v1/trading/balance` 查询账户余额。
- 新增 `apps/core/api/routes/market.py`：
  - `GET /api/v1/market/klines` 与 `GET /api/v1/market/orderbook`（从适配器获取，落库到 `kline_data/orderbook_snapshots`）。
- 新增 `apps/core/api/routes/strategies.py`：
  - 模板/实例 CRUD（表 `strategy_templates/strategy_instances`），`POST /instances/{id}/start|stop` 预留。
- 路由统一 `api/v1` 前缀，同时保留现有 `/api/auth|users|config|news` 以平滑过渡。

### 阶段3：适配器与配置接入
- 读取 `configs/exchanges.yaml` 构建 `ExchangeManager`，支持 Gate.io 与 Binance；校验与速率限制基础逻辑。
- 为交易端点注入 `ExchangeManager`（依赖注入 `deps.py`），按用户/实例选择交易所。

### 阶段4：RSS模块增强
- 新增 Celery 任务：根据 `market_news` 计算并写入 `news_price_correlation`（5m/15m/1h 窗口）。
- 在新闻发布后触发事件（兼容后续通知）。

### 阶段5：通知服务基础落地
- 在通知服务中新增渠道 `telegram/webhook/email` 与配置校验；暴露 `POST /api/v1/notify/test` 验证发送。
- 核心服务内置简易发布器，先以 HTTP 方式调用通知服务；后续再接入 RabbitMQ 事件消费。

### 阶段6：前端最低改动与联调
- 对齐前端服务调用路径至 `api/v1`，新增页面按钮联调 `trading/market/strategies` 基础端点。
- 验证 `/health` 与关键API端到端可用。

### 阶段7：事件系统与回测（下一步）
- 引入 `core/events`（publisher/subscribers），以 RabbitMQ 做事件流水（订单成交、风险预警、新闻发布）。
- 接入备份中的 `strategy-platform/backtest` 至独立服务或核心内置模块，逐步对齐设计文档。

### 交付与验证
- 本地以 Docker Compose 启动全部服务，运行健康检查与冒烟用例；新增基础集成测试覆盖交易下单/余额查询/新闻拉取。
- 提供执行清单与变更点摘要，逐步提交可审阅的代码变更（函数集注释齐备）。